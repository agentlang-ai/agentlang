(component :WeatherService)

(entity
 :Weather
 {:Id :Identity
  :Date :Now
  :City {:type :String :indexed true}
  :Temperature :Double
  :Description {:type :String :optional true}})

(event
 :GetWeatherForCity
 {:meta {:doc "Get the latest weather report for a given city."}
  :City :String})

(dataflow
 :GetWeatherForCity
 {:Weather?
  {:where [:= :City :GetWeatherForCity.City]
   :order-by [:Date]}
  :as [:Result]}
 :Result)
