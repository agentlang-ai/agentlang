(ns sample.test
  (:use [fractl.lang]))

(component :Sample.Test)

(record
 :HelloWorld
 {:Name :Kernel/String
  :Message :Kernel/String})

(dataflow
 :SayHello
 {:HelloWorld
  {:Name :SayHello.Name
   :Message '(str "Hello World from " :SayHello.Name)}})

(entity
 :Sample.Test/SalaryInfo
 {:Salary :Kernel/Int})

(entity
 :Sample.Test/PersonalInfo
 {:Age :Kernel/Int
  :Salary :Kernel/Int})

(entity
 :Sample.Test/SalaryInfoOffice
 {:Salaries {:listof :Sample.Test/SalaryInfo}})

(event
 {:Sample.Test/AddPersonalInfo
  {:Age :Kernel/Int}})

(dataflow
 :Sample.Test/AddPersonalInfo
 {:Sample.Test/SalaryInfoOffice
  {:Salaries [{:Sample.Test/SalaryInfo
               {:Salary 12}}
              {:Sample.Test/SalaryInfo
               {:Salary 15}}]}}
 [:for-each
  :Sample.Test/SalaryInfoOffice.Salaries
  {:Sample.Test/PersonalInfo
   {:Age :Sample.Test/AddPersonalInfo.Age
    :Salary :%.Salary}}])
